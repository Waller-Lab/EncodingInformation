<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>encoding_information.models package &mdash; Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EncodingInformation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="information_estimation.html">Information Estimation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_utils.html">Image Processing Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_utils.html">Plot Utilities Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EncodingInformation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">encoding_information.models package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/encoding_information.models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="encoding-information-models-package">
<h1>encoding_information.models package<a class="headerlink" href="#encoding-information-models-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-encoding_information.models.conditional_entropy_models">
<span id="encoding-information-models-conditional-entropy-models-module"></span><h2>encoding_information.models.conditional_entropy_models module<a class="headerlink" href="#module-encoding_information.models.conditional_entropy_models" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.conditional_entropy_models.AnalyticGaussianNoiseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.conditional_entropy_models.</span></span><span class="sig-name descname"><span class="pre">AnalyticGaussianNoiseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.conditional_entropy_models.AnalyticGaussianNoiseModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#encoding_information.models.model_base_class.MeasurementNoiseModel" title="encoding_information.models.model_base_class.MeasurementNoiseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeasurementNoiseModel</span></code></a></p>
<p>Analytical model for estimating the conditional entropy H(Y | X) when the noise proces
is additive independent Gaussian noise at each pixel.</p>
<p>Initialize the AnalyticGaussianNoiseModel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigma</strong> (<em>float</em>) – Standard deviation of the Gaussian noise.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.conditional_entropy_models.AnalyticGaussianNoiseModel.estimate_conditional_entropy">
<span class="sig-name descname"><span class="pre">estimate_conditional_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.conditional_entropy_models.AnalyticGaussianNoiseModel.estimate_conditional_entropy" title="Link to this definition"></a></dt>
<dd><p>Compute the conditional entropy H(Y | X) for Gaussian noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>images</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – Unused in this model. The parameter is kept for compatibility.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed conditional entropy, given by the formula:
0.5 * log(2 * pi * e * sigma^2).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.conditional_entropy_models.PoissonNoiseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.conditional_entropy_models.</span></span><span class="sig-name descname"><span class="pre">PoissonNoiseModel</span></span><a class="headerlink" href="#encoding_information.models.conditional_entropy_models.PoissonNoiseModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#encoding_information.models.model_base_class.MeasurementNoiseModel" title="encoding_information.models.model_base_class.MeasurementNoiseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeasurementNoiseModel</span></code></a></p>
<p>Poisson noise model for estimating the conditional entropy H(Y | X) from empirical data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.conditional_entropy_models.PoissonNoiseModel.estimate_conditional_entropy">
<span class="sig-name descname"><span class="pre">estimate_conditional_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.conditional_entropy_models.PoissonNoiseModel.estimate_conditional_entropy" title="Link to this definition"></a></dt>
<dd><p>Compute the conditional entropy H(Y | X) for Poisson noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>images</strong> (<em>jax.Array</em>) – A dataset of images, preferably clean. This is used to compute the conditional entropy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The average conditional entropy per pixel, computed using a Gaussian approximation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-encoding_information.models.gaussian_process">
<span id="encoding-information-models-gaussian-process-module"></span><h2>encoding_information.models.gaussian_process module<a class="headerlink" href="#module-encoding_information.models.gaussian_process" title="Link to this heading"></a></h2>
<p>Functions for computing and sampling from Gaussian processes</p>
<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.FullGaussianProcess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">FullGaussianProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalue_floor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.FullGaussianProcess" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#encoding_information.models.model_base_class.MeasurementModel" title="encoding_information.models.model_base_class.MeasurementModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeasurementModel</span></code></a></p>
<p>Full (non-stationary) Gaussian process for arbitrary data.</p>
<p>This model estimates a full covariance matrix from the data and uses it to generate or evaluate samples.</p>
<p>Initialize the Full Gaussian Process model and estimate the mean and covariance matrix from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – Input data used to estimate the Gaussian process.</p></li>
<li><p><strong>eigenvalue_floor</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum eigenvalue to ensure the covariance matrix is positive definite (default is 1e-3).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress during computation (default is False).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.FullGaussianProcess.compute_negative_log_likelihood">
<span class="sig-name descname"><span class="pre">compute_negative_log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.FullGaussianProcess.compute_negative_log_likelihood" title="Link to this definition"></a></dt>
<dd><p>Compute the negative log-likelihood of the provided data under the Gaussian process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – Input data to evaluate.</p></li>
<li><p><strong>data_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for shuffling the data.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress (default is True).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>deprecated</em>) – Deprecated argument for random seed, use <cite>data_seed</cite> instead.</p></li>
<li><p><strong>average</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to average the negative log-likelihood over all samples (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The negative log-likelihood of the provided data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.FullGaussianProcess.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.FullGaussianProcess.fit" title="Link to this definition"></a></dt>
<dd><p>Fit method is not needed for the Full Gaussian Process since the model is already fully estimated.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Warning</strong> – This method raises a warning because fitting is not necessary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.FullGaussianProcess.generate_samples">
<span class="sig-name descname"><span class="pre">generate_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_nonnegative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.FullGaussianProcess.generate_samples" title="Link to this definition"></a></dt>
<dd><p>Generate new samples from the learned Gaussian process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to generate.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Shape of the samples to generate (default is the shape of the training data).</p></li>
<li><p><strong>ensure_nonnegative</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to ensure all values are non-negative (default is True).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.StationaryGaussianProcess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">StationaryGaussianProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalue_floor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.StationaryGaussianProcess" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#encoding_information.models.model_base_class.MeasurementModel" title="encoding_information.models.model_base_class.MeasurementModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeasurementModel</span></code></a></p>
<p>Stationary 2D Gaussian process for single-channel images.</p>
<p>This model learns a stationary covariance matrix and uses it to generate or evaluate samples.</p>
<p>Initialize the StationaryGaussianProcess model and estimate the covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>ndarray</em>) – Input images used to estimate the stationary covariance matrix.</p></li>
<li><p><strong>eigenvalue_floor</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum eigenvalue to ensure the covariance matrix is positive definite (default is 1e-3).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress and additional information (default is False).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.StationaryGaussianProcess.compute_analytic_entropy">
<span class="sig-name descname"><span class="pre">compute_analytic_entropy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.StationaryGaussianProcess.compute_analytic_entropy" title="Link to this definition"></a></dt>
<dd><p>Compute the differential entropy per pixel of the Gaussian process</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.StationaryGaussianProcess.compute_negative_log_likelihood">
<span class="sig-name descname"><span class="pre">compute_negative_log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.StationaryGaussianProcess.compute_negative_log_likelihood" title="Link to this definition"></a></dt>
<dd><p>Compute the negative log-likelihood of the provided images under the learned Gaussian process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>ndarray</em>) – Input images to evaluate.</p></li>
<li><p><strong>data_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for shuffling the data.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress (default is True).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>deprecated</em>) – Deprecated argument for random seed, use <cite>data_seed</cite> instead.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The negative log-likelihood of the provided images.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.StationaryGaussianProcess.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_val_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_samples_for_validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalue_floor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precondition_gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.StationaryGaussianProcess.fit" title="Link to this definition"></a></dt>
<dd><p>Train the Stationary Gaussian Process model on the provided images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_images</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The training dataset consisting of images (default is the images provided during initialization).</p></li>
<li><p><strong>data_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for shuffling the data.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Learning rate for optimization (default is 1e2).</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of training epochs (default is 60).</p></li>
<li><p><strong>steps_per_epoch</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps per epoch (default is 1).</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of epochs to wait for early stopping (default is 15).</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of images in each batch (default is 12).</p></li>
<li><p><strong>num_val_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of validation samples (default is computed automatically based on <cite>percent_samples_for_validation</cite>).</p></li>
<li><p><strong>percent_samples_for_validation</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of samples to use for validation (default is 0.1).</p></li>
<li><p><strong>eigenvalue_floor</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum eigenvalue to ensure the covariance matrix is positive definite (default is 1e-3).</p></li>
<li><p><strong>gradient_clip</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum value to clip the gradient to avoid large updates (default is 1).</p></li>
<li><p><strong>momentum</strong> (<em>float</em><em>, </em><em>optional</em>) – Momentum parameter for the optimizer (default is 0.9).</p></li>
<li><p><strong>precondition_gradient</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to precondition the gradient using the Fisher Information Matrix (default is False).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>val_loss_history</strong> – A list of validation losses for each epoch.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.StationaryGaussianProcess.generate_samples">
<span class="sig-name descname"><span class="pre">generate_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_nonnegative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.StationaryGaussianProcess.generate_samples" title="Link to this definition"></a></dt>
<dd><p>Generate new image samples from the learned Gaussian process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_samples</strong> (<em>int</em>) – The number of samples to generate.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Shape of the samples to generate (default is the shape of the training images).</p></li>
<li><p><strong>ensure_nonnegative</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to ensure all pixel values are non-negative (default is True).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated image samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.StationaryGaussianProcess.get_cov_mat">
<span class="sig-name descname"><span class="pre">get_cov_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.StationaryGaussianProcess.get_cov_mat" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.StationaryGaussianProcess.get_mean_vec">
<span class="sig-name descname"><span class="pre">get_mean_vec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.StationaryGaussianProcess.get_mean_vec" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.average_diagonals_to_make_doubly_toeplitz">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">average_diagonals_to_make_doubly_toeplitz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.average_diagonals_to_make_doubly_toeplitz" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.estimate_full_cov_mat">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">estimate_full_cov_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patches</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.estimate_full_cov_mat" title="Link to this definition"></a></dt>
<dd><p>Take an NxWxH stack of patches, and compute the covariance matrix of the vectorized patches</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.gaussian_likelihood">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">gaussian_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.gaussian_likelihood" title="Link to this definition"></a></dt>
<dd><p>Evaluate the log likelihood of a multivariate gaussian
for a batch of NxWXH samples.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.generate_multivariate_gaussian_samples">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">generate_multivariate_gaussian_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.generate_multivariate_gaussian_samples" title="Link to this definition"></a></dt>
<dd><p>Generate samples from a 2D gaussian process with the given covariance matrix</p>
<p>Args:
cov_mat: jnp.ndarray, covariance matrix of the Gaussian distribution
num_samples: int, number of samples to generate
seed: int or jnp.ndarray, seed for the random number generator
key: a jax.random.PRNGKey, if None, use the seed to generate one</p>
<p>Returns:
jnp.ndarray of shape (num_samples, cov_mat.shape[0]), samples from the multivariate Gaussian distribution</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.generate_stationary_gaussian_process_samples">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">generate_stationary_gaussian_process_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_nonnegative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefer_iterative_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.generate_stationary_gaussian_process_samples" title="Link to this definition"></a></dt>
<dd><p>Given a covariance matrix of a stationary Gaussian process, generate samples from it. If the sample_size
is less than or equal to the patch size used to generate the covariance matrix, this will be relatively
fast. If it is larger, it will be slower and linear in the number additional pixels, since each new
pixel is sampled conditional on the previous ones.</p>
<p>cov_mat : The covariance matrix of a stationary Gaussian process
num_samples : int number of samples to generate</p>
<dl class="simple">
<dt>sample_size<span class="classifier">int that is the one dimensional shape of a patch that the new</span></dt><dd><p>covariance matrix represents the size of the covariance matrix is the patch size squared.
if None, use the same patch size as the covariance matrix</p>
</dd>
</dl>
<p>mean : mean of the Gaussian process. If None, use zero mean
ensure_nonnegative : bool if true, ensure that all pixel values of sampls are nonnegative
prefer_iterative_sampling : bool if true, dont directly sample the first (patch_size, patch_size) pixels</p>
<blockquote>
<div><p>directly from the covariance matrix. Instead, sample them iteratively from the previous pixels.
This is much slower</p>
</div></blockquote>
<p>seed : int , seed for the random number generator
verbose : bool if true, print progress</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.make_positive_definite">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">make_positive_definite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalue_floor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.make_positive_definite" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.match_to_generator_data">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">match_to_generator_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.match_to_generator_data" title="Link to this definition"></a></dt>
<dd><p>Important: during the training process, noise is added to the pixel values to account for the
fact that discrete pixel values are used with a continuous density in the model. This is handled by the
make_dataset_generator function in the image_distribution_models module. So we call this here on a the images
to ensure that the same noise is added to the images here as was added during training, and then convert back
to a jax array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.nll_per_pixel_from_cov_mat">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">nll_per_pixel_from_cov_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pixels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.nll_per_pixel_from_cov_mat" title="Link to this definition"></a></dt>
<dd><p>Negative log likelihood of a multivariate gaussian per pixel</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.plugin_estimate_stationary_cov_mat">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">plugin_estimate_stationary_cov_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalue_floor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.plugin_estimate_stationary_cov_mat" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.gaussian_process.try_to_make_doubly_toeplitz_and_positive_definite">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.gaussian_process.</span></span><span class="sig-name descname"><span class="pre">try_to_make_doubly_toeplitz_and_positive_definite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig_vecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalue_floor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.gaussian_process.try_to_make_doubly_toeplitz_and_positive_definite" title="Link to this definition"></a></dt>
<dd><p>Average along diagonals and block diagonals to make a doubly toeplitz matrix,
then make sure it is positive definite by setting all eigenvalues below
eigenvalue_floor to eigenvalue_floor to get rid of negative eigenvalues.</p>
<p>This won’t neccesarily return a doubly toeplitz matrix, but it will be positive definite.</p>
</dd></dl>

</section>
<section id="module-encoding_information.models.model_base_class">
<span id="encoding-information-models-model-base-class-module"></span><h2>encoding_information.models.model_base_class module<a class="headerlink" href="#module-encoding_information.models.model_base_class" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.model_base_class.</span></span><span class="sig-name descname"><span class="pre">MeasurementModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measurement_types:</span> <span class="pre">~encoding_information.models.model_base_class.MeasurementType</span> <span class="pre">|</span> <span class="pre">~typing.List[~encoding_information.models.model_base_class.MeasurementType]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurement_dtype:</span> <span class="pre">type</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for probabilistic models of images and other measurement data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>measurement_types</strong> (<em>Union</em><em>[</em><a class="reference internal" href="#encoding_information.models.model_base_class.MeasurementType" title="encoding_information.models.model_base_class.MeasurementType"><em>MeasurementType</em></a><em>, </em><em>List</em><em>[</em><a class="reference internal" href="#encoding_information.models.model_base_class.MeasurementType" title="encoding_information.models.model_base_class.MeasurementType"><em>MeasurementType</em></a><em>]</em><em>]</em><em>, </em><em>optional</em>) – The type(s) of measurements supported by this model. If None, all types are supported.</p></li>
<li><p><strong>measurement_dtype</strong> (<em>type</em><em>, </em><em>optional</em>) – The data type of the measurements, either float or complex.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementModel.measurement_types">
<span class="sig-name descname"><span class="pre">measurement_types</span></span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementModel.measurement_types" title="Link to this definition"></a></dt>
<dd><p>A list of supported measurement types.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementModel.measurement_dtype">
<span class="sig-name descname"><span class="pre">measurement_dtype</span></span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementModel.measurement_dtype" title="Link to this definition"></a></dt>
<dd><p>The data type of the measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>type</p>
</dd>
</dl>
</dd></dl>

<p>Initialize the model with the type of measurement and data type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>measurement_type</strong> (<a class="reference internal" href="#encoding_information.models.model_base_class.MeasurementType" title="encoding_information.models.model_base_class.MeasurementType"><em>MeasurementType</em></a>) – Type of measurement (MeasurementType.HW, MeasurementType.HWC, or MeasurementType.D).
If None, then the model can accept any type of measurement.</p></li>
<li><p><strong>measurement_dtype</strong> (<em>type</em>) – Data type of the measurements (float or complex)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementModel.compute_negative_log_likelihood">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_negative_log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">123</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementModel.compute_negative_log_likelihood" title="Link to this definition"></a></dt>
<dd><p>Compute the NLL of the images under the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>ndarray</em>) – Array of images, shape (N, H, W)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress</p></li>
<li><p><strong>data_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for shuffling images (and possibly adding noise)</p></li>
<li><p><strong>average</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to average the NLL over all images</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>log_likelihood</strong> – Average negative log-likelihood of all images</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_val_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_samples_for_validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementModel.fit" title="Link to this definition"></a></dt>
<dd><p>Train the model on the provided images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_images</strong> (<em>ndarray</em>) – The training dataset consisting of images, with shape (N, H, W).</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – The learning rate for optimization (default is 1e-2).</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of training epochs (default is 200).</p></li>
<li><p><strong>steps_per_epoch</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps per epoch (default is 100).</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of epochs to wait for improvement before early stopping (default is 10).</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of images in each batch (default is 64).</p></li>
<li><p><strong>num_val_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of validation samples to use, or None to compute automatically.</p></li>
<li><p><strong>percent_samples_for_validation</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of samples to use for validation (default is 0.1).</p></li>
<li><p><strong>data_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for data shuffling.</p></li>
<li><p><strong>model_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for model initialization.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print training progress (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>val_loss_history</strong> – A list of validation losses at each epoch.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementModel.generate_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementModel.generate_samples" title="Link to this definition"></a></dt>
<dd><p>Generate samples from the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_samples</strong> (<em>int</em>) – The number of samples to generate.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The shape of each sample. If None, the model will use the training image shape.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>samples</strong> – Generated samples from the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementNoiseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.model_base_class.</span></span><span class="sig-name descname"><span class="pre">MeasurementNoiseModel</span></span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementNoiseModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for noise models applied to measurement data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementNoiseModel.estimate_conditional_entropy">
<span class="sig-name descname"><span class="pre">estimate_conditional_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementNoiseModel.estimate_conditional_entropy" title="Link to this definition"></a></dt>
<dd><p>Abstract method for estimating conditional entropy, which must be implemented by derived classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_conditional_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Estimate the conditional entropy for a given noise model.</p>
<p>This is an abstract method that must be implemented by subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>tuple</em>) – Additional arguments needed for estimating conditional entropy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The estimated conditional entropy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.model_base_class.</span></span><span class="sig-name descname"><span class="pre">MeasurementType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Enum class to define different types of measurements.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementType.HW">
<span class="sig-name descname"><span class="pre">HW</span></span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementType.HW" title="Link to this definition"></a></dt>
<dd><p>Single-channel image measurement (Height, Width).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Enum</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementType.HWC">
<span class="sig-name descname"><span class="pre">HWC</span></span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementType.HWC" title="Link to this definition"></a></dt>
<dd><p>Multi-channel image measurement (Height, Width, Channels).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Enum</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.MeasurementType.D">
<span class="sig-name descname"><span class="pre">D</span></span><a class="headerlink" href="#encoding_information.models.model_base_class.MeasurementType.D" title="Link to this definition"></a></dt>
<dd><p>Vectorized data measurement.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Enum</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">D</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">HW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">HWC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.make_dataset_generators">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.model_base_class.</span></span><span class="sig-name descname"><span class="pre">make_dataset_generators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_val_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_uniform_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_gaussian_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.model_base_class.make_dataset_generators" title="Link to this definition"></a></dt>
<dd><p>Create TensorFlow dataset generators for training and validation data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – The input data, shape (N, H, W).</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – The number of samples per batch.</p></li>
<li><p><strong>num_val_samples</strong> (<em>int</em>) – Number of validation samples.</p></li>
<li><p><strong>add_uniform_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add uniform noise to the data (default is True).</p></li>
<li><p><strong>add_gaussian_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add Gaussian noise to the data (default is False).</p></li>
<li><p><strong>condition_vectors</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Conditioning vectors associated with the images.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>train_ds</strong> (<em>tf.data.Dataset</em>) – TensorFlow dataset iterator for training data.</p></li>
<li><p><strong>val_ds</strong> (<em>callable</em>) – A function that returns a TensorFlow dataset iterator for validation data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="encoding_information.models.model_base_class.train_model">
<span class="sig-prename descclassname"><span class="pre">encoding_information.models.model_base_class.</span></span><span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_val_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_gaussian_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_uniform_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.model_base_class.train_model" title="Link to this definition"></a></dt>
<dd><p>Train the model with early stopping based on validation performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_images</strong> (<em>ndarray</em>) – The training dataset consisting of images, with shape (N, H, W).</p></li>
<li><p><strong>state</strong> (<em>flax.linen.Module</em>) – The model state.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – The number of samples per batch.</p></li>
<li><p><strong>num_val_samples</strong> (<em>int</em>) – The number of validation samples.</p></li>
<li><p><strong>steps_per_epoch</strong> (<em>int</em>) – Number of steps per epoch.</p></li>
<li><p><strong>num_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>patience</strong> (<em>int</em>) – Number of epochs to wait before early stopping.</p></li>
<li><p><strong>train_step</strong> (<em>callable</em>) – The function to perform a single training step.</p></li>
<li><p><strong>condition_vectors</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Conditioning vectors associated with the images.</p></li>
<li><p><strong>add_gaussian_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add Gaussian noise to the training data (default is False).</p></li>
<li><p><strong>add_uniform_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add uniform noise to the training data (default is True).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print training progress (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>best_params</strong> (<em>flax.linen.Module.params</em>) – The model parameters that achieved the best validation performance.</p></li>
<li><p><strong>val_loss_history</strong> (<em>list</em>) – A list of validation losses for each epoch.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-encoding_information.models.pixel_cnn">
<span id="encoding-information-models-pixel-cnn-module"></span><h2>encoding_information.models.pixel_cnn module<a class="headerlink" href="#module-encoding_information.models.pixel_cnn" title="Link to this heading"></a></h2>
<p>PixelCNN in Jax/Flax. Adapted from :
<a class="reference external" href="https://uvadlc-notebooks.readthedocs.io/en/latest/tutorial_notebooks/JAX/tutorial12/Autoregressive_Image_Modeling.html">https://uvadlc-notebooks.readthedocs.io/en/latest/tutorial_notebooks/JAX/tutorial12/Autoregressive_Image_Modeling.html</a></p>
<p>Mixture density output adapted from:
<a class="reference external" href="https://github.com/hardmaru/mdn_jax_tutorial/blob/master/mixture_density_networks_jax.ipynb">https://github.com/hardmaru/mdn_jax_tutorial/blob/master/mixture_density_networks_jax.ipynb</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.GatedMaskedConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.pixel_cnn.</span></span><span class="sig-name descname"><span class="pre">GatedMaskedConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dilation:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_vector_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~typing.Type[~flax.linen.module.Module]</span> <span class="pre">|</span> <span class="pre">~flax.core.scope.Scope</span> <span class="pre">|</span> <span class="pre">~typing.Type[~flax.linen.module._Sentinel]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.GatedMaskedConv" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A gated masked convolution layer used in PixelCNN. This layer uses gated activation functions
to improve gradient flow during training.</p>
<p>It combines information from a vertical stack and a horizontal stack, each being passed through
masked convolutions, and optionally conditioned on an external vector (such as class labels).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.GatedMaskedConv.dilation">
<span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.GatedMaskedConv.dilation" title="Link to this definition"></a></dt>
<dd><p>The dilation factor for the convolutions (default is 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.GatedMaskedConv.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.GatedMaskedConv.id" title="Link to this definition"></a></dt>
<dd><p>The layer ID, used for parameter naming.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.GatedMaskedConv.condition_vector_size">
<span class="sig-name descname"><span class="pre">condition_vector_size</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.GatedMaskedConv.condition_vector_size" title="Link to this definition"></a></dt>
<dd><p>The size of the condition vector for conditional PixelCNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">condition_vector_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">dilation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.GatedMaskedConv.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.GatedMaskedConv.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.GatedMaskedConv.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">_Sentinel</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.GatedMaskedConv.parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.GatedMaskedConv.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.GatedMaskedConv.scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.pixel_cnn.</span></span><span class="sig-name descname"><span class="pre">HorizontalStackConvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_out:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_center:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~typing.Type[~flax.linen.module.Module]</span> <span class="pre">|</span> <span class="pre">~flax.core.scope.Scope</span> <span class="pre">|</span> <span class="pre">~typing.Type[~flax.linen.module._Sentinel]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A horizontal convolutional layer that processes the pixels to the left of the current pixel in an image.</p>
<p>This layer creates a horizontal stack by masking the convolution kernel, ensuring that the pixels
to the right of the current pixel are not visible during the convolution.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution.c_out">
<span class="sig-name descname"><span class="pre">c_out</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution.c_out" title="Link to this definition"></a></dt>
<dd><p>The number of output channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution.kernel_size">
<span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution.kernel_size" title="Link to this definition"></a></dt>
<dd><p>The size of the convolution kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution.mask_center">
<span class="sig-name descname"><span class="pre">mask_center</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution.mask_center" title="Link to this definition"></a></dt>
<dd><p>Whether to mask out the center pixel in the kernel (default is False).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution.dilation">
<span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution.dilation" title="Link to this definition"></a></dt>
<dd><p>The dilation factor for the convolution (default is 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">c_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">dilation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">kernel_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">mask_center</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">_Sentinel</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution.parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution.scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.HorizontalStackConvolution.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.HorizontalStackConvolution.setup" title="Link to this definition"></a></dt>
<dd><p>Initializes a Module lazily (similar to a lazy <code class="docutils literal notranslate"><span class="pre">__init__</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">setup</span></code> is called once lazily on a module instance when a module
is bound, immediately before any other methods like <code class="docutils literal notranslate"><span class="pre">__call__</span></code> are
invoked, or before a <code class="docutils literal notranslate"><span class="pre">setup</span></code>-defined attribute on <code class="docutils literal notranslate"><span class="pre">self</span></code> is accessed.</p>
<p>This can happen in three cases:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Immediately when invoking <code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">init()</span></code> or
<code class="xref py py-meth docutils literal notranslate"><span class="pre">init_and_output()</span></code>.</p></li>
<li><p>Once the module is given a name by being assigned to an attribute of
another module inside the other module’s <code class="docutils literal notranslate"><span class="pre">setup</span></code> method
(see <code class="xref py py-meth docutils literal notranslate"><span class="pre">__setattr__()</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyModule</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">submodule</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="go">...     # Accessing `submodule` attributes does not yet work here.</span>

<span class="go">...     # The following line invokes `self.__setattr__`, which gives</span>
<span class="go">...     # `submodule` the name &quot;conv1&quot;.</span>
<span class="go">...     self.conv1 = submodule</span>

<span class="go">...     # Accessing `submodule` attributes or methods is now safe and</span>
<span class="go">...     # either causes setup() to be called once.</span>
</pre></div>
</div>
</li>
<li><p>Once a module is constructed inside a method wrapped with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">compact()</span></code>, immediately before another method is called or
<code class="docutils literal notranslate"><span class="pre">setup</span></code> defined attribute is accessed.</p></li>
</ol>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.MaskedConvolution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.pixel_cnn.</span></span><span class="sig-name descname"><span class="pre">MaskedConvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_out:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask:</span> <span class="pre">~jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~typing.Type[~flax.linen.module.Module]</span> <span class="pre">|</span> <span class="pre">~flax.core.scope.Scope</span> <span class="pre">|</span> <span class="pre">~typing.Type[~flax.linen.module._Sentinel]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.MaskedConvolution" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A convolutional layer with a mask to ensure autoregressive behavior.</p>
<p>This layer ensures that during the convolution, the current pixel does not
have access to any future pixels (either to the right or below in the image).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.MaskedConvolution.c_out">
<span class="sig-name descname"><span class="pre">c_out</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.MaskedConvolution.c_out" title="Link to this definition"></a></dt>
<dd><p>The number of output channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.MaskedConvolution.mask">
<span class="sig-name descname"><span class="pre">mask</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.MaskedConvolution.mask" title="Link to this definition"></a></dt>
<dd><p>The mask to apply to the convolution, determining which pixels are visible.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.MaskedConvolution.dilation">
<span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.MaskedConvolution.dilation" title="Link to this definition"></a></dt>
<dd><p>The dilation factor for the convolution (default is 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">c_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">dilation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">mask</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.MaskedConvolution.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.MaskedConvolution.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.MaskedConvolution.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">_Sentinel</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.MaskedConvolution.parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.MaskedConvolution.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.MaskedConvolution.scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PixelCNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.pixel_cnn.</span></span><span class="sig-name descname"><span class="pre">PixelCNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_hidden_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mixture_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PixelCNN" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#encoding_information.models.model_base_class.MeasurementModel" title="encoding_information.models.model_base_class.MeasurementModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeasurementModel</span></code></a></p>
<p>The PixelCNN model for autoregressive image modeling.</p>
<p>This class handles the training and evaluation of the PixelCNN model and wraps the Flax implementation
in a higher-level interface that conforms to the MeasurementModel class. It provides methods for fitting
the model to data, computing the negative log-likelihood of images, and generating new images.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PixelCNN.num_hidden_channels">
<span class="sig-name descname"><span class="pre">num_hidden_channels</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PixelCNN.num_hidden_channels" title="Link to this definition"></a></dt>
<dd><p>The number of hidden channels in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PixelCNN.num_mixture_components">
<span class="sig-name descname"><span class="pre">num_mixture_components</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PixelCNN.num_mixture_components" title="Link to this definition"></a></dt>
<dd><p>The number of components in the mixture density output.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialize the PixelCNN model with image shape, number of hidden channels, and mixture components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_shape</strong> (<em>tuple</em><em> of </em><em>int</em>) – Shape of the input image (height, width).</p></li>
<li><p><strong>num_hidden_channels</strong> (<em>int</em>) – Number of hidden channels in the convolutional layers.</p></li>
<li><p><strong>num_mixture_components</strong> (<em>int</em>) – Number of mixture components for the output layer.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PixelCNN.compute_negative_log_likelihood">
<span class="sig-name descname"><span class="pre">compute_negative_log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditioning_vecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PixelCNN.compute_negative_log_likelihood" title="Link to this definition"></a></dt>
<dd><p>Compute the negative log-likelihood (NLL) of images under the trained PixelCNN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – The input images for which to compute the NLL.</p></li>
<li><p><strong>conditioning_vecs</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Vectors to condition the image generation process (e.g., class labels).</p></li>
<li><p><strong>data_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for data shuffling.</p></li>
<li><p><strong>average</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return the average NLL over all images (default is True).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress (default is True).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Deprecated. Use data_seed instead.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>nll</strong> – The negative log-likelihood of the input images.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PixelCNN.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_val_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_samples_for_validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_lr_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_gaussian_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_uniform_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_positional_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PixelCNN.fit" title="Link to this definition"></a></dt>
<dd><p>Train the PixelCNN model on a dataset of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_images</strong> (<em>ndarray</em>) – The input dataset, with shape (N, H, W, C).</p></li>
<li><p><strong>condition_vectors</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Vectors to condition the image generation process (e.g., class labels).</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – The learning rate for optimization (default is 1e-2).</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of training epochs (default is 200).</p></li>
<li><p><strong>steps_per_epoch</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of steps per epoch (default is 100).</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of epochs to wait before early stopping (default is 40).</p></li>
<li><p><strong>sigma_min</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum standard deviation for the mixture density output (default is 1).</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The batch size for training (default is 64).</p></li>
<li><p><strong>num_val_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of validation samples. If None, a percentage is used (default is None).</p></li>
<li><p><strong>percent_samples_for_validation</strong> (<em>float</em><em>, </em><em>optional</em>) – The percentage of samples to use for validation (default is 0.1).</p></li>
<li><p><strong>do_lr_decay</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply learning rate decay during training (default is False).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress during training (default is True).</p></li>
<li><p><strong>add_gaussian_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add Gaussian noise to the training images (default is False).</p></li>
<li><p><strong>add_uniform_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add uniform noise to the training images (default is True).</p></li>
<li><p><strong>model_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for model initialization.</p></li>
<li><p><strong>data_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for data shuffling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>val_loss_history</strong> – A list of validation loss values for each epoch.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PixelCNN.generate_samples">
<span class="sig-name descname"><span class="pre">generate_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditioning_vecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_nonnegative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PixelCNN.generate_samples" title="Link to this definition"></a></dt>
<dd><p>Generate new images from the trained PixelCNN model by sampling pixel by pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of images to generate.</p></li>
<li><p><strong>conditioning_vecs</strong> (<em>jax.Array</em><em>, </em><em>optional</em>) – Optional conditioning vectors. If provided, the shape should match
(num_samples, condition_vector_size). Default is None.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em><em> of </em><em>int</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – Shape of the images to generate. If None, the model’s image_shape is used.
If a single int is provided, it will be treated as a square shape. Default is None.</p></li>
<li><p><strong>ensure_nonnegative</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, ensure that the generated pixel values are non-negative. Default is True.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility. Default is 123 if not provided.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, display progress during the generation process. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated images with the specified shape.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PreprocessLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.pixel_cnn.</span></span><span class="sig-name descname"><span class="pre">PreprocessLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean:</span> <span class="pre">~jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std:</span> <span class="pre">~jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~typing.Type[~flax.linen.module.Module]</span> <span class="pre">|</span> <span class="pre">~flax.core.scope.Scope</span> <span class="pre">|</span> <span class="pre">~typing.Type[~flax.linen.module._Sentinel]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PreprocessLayer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A layer that normalizes the input images using the provided mean and standard deviation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PreprocessLayer.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PreprocessLayer.mean" title="Link to this definition"></a></dt>
<dd><p>The mean to subtract from the input images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PreprocessLayer.std">
<span class="sig-name descname"><span class="pre">std</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.PreprocessLayer.std" title="Link to this definition"></a></dt>
<dd><p>The standard deviation to divide the input images by.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">mean</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PreprocessLayer.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.PreprocessLayer.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PreprocessLayer.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">_Sentinel</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.PreprocessLayer.parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.PreprocessLayer.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.PreprocessLayer.scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">std</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">encoding_information.models.pixel_cnn.</span></span><span class="sig-name descname"><span class="pre">VerticalStackConvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_out:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_center:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~typing.Type[~flax.linen.module.Module]</span> <span class="pre">|</span> <span class="pre">~flax.core.scope.Scope</span> <span class="pre">|</span> <span class="pre">~typing.Type[~flax.linen.module._Sentinel]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A vertical convolutional layer that processes the pixels above the current pixel in an image.</p>
<p>This layer creates a vertical stack by masking the convolution kernel, ensuring that the pixels
below the current pixel are not visible during the convolution.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution.c_out">
<span class="sig-name descname"><span class="pre">c_out</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution.c_out" title="Link to this definition"></a></dt>
<dd><p>The number of output channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution.kernel_size">
<span class="sig-name descname"><span class="pre">kernel_size</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution.kernel_size" title="Link to this definition"></a></dt>
<dd><p>The size of the convolution kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution.mask_center">
<span class="sig-name descname"><span class="pre">mask_center</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution.mask_center" title="Link to this definition"></a></dt>
<dd><p>Whether to mask out the center pixel in the kernel (default is False).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution.dilation">
<span class="sig-name descname"><span class="pre">dilation</span></span><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution.dilation" title="Link to this definition"></a></dt>
<dd><p>The dilation factor for the convolution (default is 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">c_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">dilation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">kernel_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">mask_center</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">_Sentinel</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution.parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution.scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="encoding_information.models.pixel_cnn.VerticalStackConvolution.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#encoding_information.models.pixel_cnn.VerticalStackConvolution.setup" title="Link to this definition"></a></dt>
<dd><p>Initializes a Module lazily (similar to a lazy <code class="docutils literal notranslate"><span class="pre">__init__</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">setup</span></code> is called once lazily on a module instance when a module
is bound, immediately before any other methods like <code class="docutils literal notranslate"><span class="pre">__call__</span></code> are
invoked, or before a <code class="docutils literal notranslate"><span class="pre">setup</span></code>-defined attribute on <code class="docutils literal notranslate"><span class="pre">self</span></code> is accessed.</p>
<p>This can happen in three cases:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Immediately when invoking <code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">init()</span></code> or
<code class="xref py py-meth docutils literal notranslate"><span class="pre">init_and_output()</span></code>.</p></li>
<li><p>Once the module is given a name by being assigned to an attribute of
another module inside the other module’s <code class="docutils literal notranslate"><span class="pre">setup</span></code> method
(see <code class="xref py py-meth docutils literal notranslate"><span class="pre">__setattr__()</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyModule</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">submodule</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="go">...     # Accessing `submodule` attributes does not yet work here.</span>

<span class="go">...     # The following line invokes `self.__setattr__`, which gives</span>
<span class="go">...     # `submodule` the name &quot;conv1&quot;.</span>
<span class="go">...     self.conv1 = submodule</span>

<span class="go">...     # Accessing `submodule` attributes or methods is now safe and</span>
<span class="go">...     # either causes setup() to be called once.</span>
</pre></div>
</div>
</li>
<li><p>Once a module is constructed inside a method wrapped with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">compact()</span></code>, immediately before another method is called or
<code class="docutils literal notranslate"><span class="pre">setup</span></code> defined attribute is accessed.</p></li>
</ol>
</div></blockquote>
</dd></dl>

</dd></dl>

</section>
<section id="module-encoding_information.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-encoding_information.models" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Henry Pinkard.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>